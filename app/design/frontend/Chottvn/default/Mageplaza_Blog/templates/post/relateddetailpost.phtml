<?php
/**
 * Mageplaza
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Mageplaza.com license that is
 * available through the world-wide-web at this URL:
 * https://www.mageplaza.com/LICENSE.txt
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 *
 * @category    Mageplaza
 * @package     Mageplaza_Blog
 * @copyright   Copyright (c) 2018 Mageplaza (http://www.mageplaza.com/)
 * @license     https://www.mageplaza.com/LICENSE.txt
 */

/** @var \Mageplaza\Blog\Model\ResourceModel\Post\Collection $posts */
$posts = $block->getRelatedPostList();
$viewAllUrl = $this->getData('view_all_url') ?? "";
$title = $block->getData("title");
$name_view_all = $this->getData('name_view');
$url_main = $block->getUrl();
?>
<?php if ($posts->getSize() > 0): ?>
   <div class="sm-listing-tabs slidertype">
        <div class="ltabs-head">
            <div class="title-home-page">
            <span><?php echo $title; ?></span>				
            </div>	
            <!--Begin Tabs-->
            <div class="ltabs-tabs-container">
            </div>
            <!-- End Tabs-->
            <!-- <div class="ltabs-view-all">
                <a href="#"><span class=""><?php //echo __('All') ?></span> <i class="fa fa-long-arrow-right"></i></a>
            </div>   -->
        </div>
        <div class="ltabs-wrap post-related">
            <div class="grid products-grid">
                <div id="owl-post-related-product" class="owl-carousel owl-theme">
                    <?php foreach ($posts as $post) :?>
                        <div class= "item">
                            <div class= "prod-box-item">
                                <div class="item-inner">
                                    <div class= "box-image-post">
                                        <?php
                                            // $url_main = $block->getUrl(); 
                                            // $url_image = $block->resizeImage($post->getImage()); 
                                            // $url_resize = $url_main."timthumb.php?src=".$url_image."&w=227&h=183";
                                        ?>
                                        <a href="<?php echo $post->getUrl(); ?>">
                                            <img title="<?php echo $post->getName() ?>" alt="<?php echo $post->getName() ?>" class="card-img-top border-big-image" src="<?php echo  $block->resizeImage($post->getImage());  ?>">
                                        </a>
                                    </div>
                                    <div class= "content-post">
                                            <h2 class ="title-post">
                                               <a class="product-item-link" href="<?php echo $post->getUrl(); ?>"><?php echo $post->getName(); ?></a>
                                            </h2>
                                        <!-- <div class="second-post">
                                            <div class="date-post">
                                                <?php
                                                $dt = new DateTime($post->getPublishDate());
                                                $date_public = $dt->format('Y-m-d');
                                                $time_public = $dt->format('H:i:s');
                                                ?>
                                                <?php echo $date_public; ?>
                                            </div>
                                            <div class="name-person-post">
                                                <?php  //echo $time_public ?> - <?php //echo $post->getNameAuthor(); ?>
                                            </div>
                                        </div> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    <?php endforeach; ?>
                </div>
            </div>
            <div class="ltabs-view-all-blog">
                <a href="<?php echo $viewAllUrl; ?>"><span><?php echo $name_view_all ; ?></span><i class="fas fa-chevron-right"></i><i class="fas fa-chevron-right"></i></a>
            </div>  
        </div>
   </div>
<?php endif; ?>
<script type="text/javascript" xml="space">
    require([
        'jquery',
        'owlcarousel'
    ], function($){
        $(document).ready(function() {
            var owl = $('#owl-post-related-product');
            $('#owl-post-related-product').owlCarousel({
            loop: false,
            items: 4, // Select Item Number
            autoplay: false,
            dots: false,
            nav: true,
            slideSpeed : 500,
            paginationSpeed : 800,
            rewindSpeed : 1000,
            autoplayHoverPause: true,
            responsiveClass:true,
            responsive:{
                0:{
                    items:1,
                    nav:true
                },
                500:{
                    items:1,
                    nav:true
                },
                800:{
                    items:3,
                    nav:true
                },
                1000:{
                    items:4,
                    nav:true,
                    loop:false
                }
            }
            });
          
        });
    });
</script>