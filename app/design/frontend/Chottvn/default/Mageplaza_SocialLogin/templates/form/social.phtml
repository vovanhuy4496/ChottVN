<?php
/**
 * Mageplaza
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Mageplaza.com license that is
 * available through the world-wide-web at this URL:
 * https://www.mageplaza.com/LICENSE.txt
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 *
 * @category    Mageplaza
 * @package     Mageplaza_SocialLogin
 * @copyright   Copyright (c) Mageplaza (https://www.mageplaza.com/)
 * @license     https://www.mageplaza.com/LICENSE.txt
 */

$availableSocials = $block->getAvailableSocials();
$childBlock = $block->getChildBlock('request.info');

if ($block->canShow() && sizeof($availableSocials)) :
    ?>
    <div class="block-content-register-social">
        <div class="block-title">
            <strong id="block-social-customer-heading" role="heading" aria-level="2"><?= $block->escapeHtml(__('Or Sign In With')) ?></strong>
        </div>
        <div class="block-content block-content-social">
            <?php foreach ($availableSocials as $key => $social) : ?>
                <div class="actions-toolbar social-btn social-btn-actions-toolbar <?= $key ?>-login">
                    <a class="btn btn-block btn-social btn-<?= $block->getBtnKey($key) ?>"
                       data-mage-init='{"socialProvider": {"url": "<?= $social['login_url'] ?>", "label": "<?= __('Login By %1', $social['label']) ?>"}}'>
                        <span class="fa fa-<?= $block->getBtnKey($key) ?>"></span>
                        <?= __('Sign in with %1', $social['label']) ?>
                    </a>
                </div>
            <?php endforeach; ?>
        </div>
    </div>
<?php endif; ?>
<?php if ($childBlock->isRequireMoreInfo()) : ?>
    <div id="social-login-popup" class="white-popup mfp-with-anim mfp-hide"
         data-mage-init='{"Mageplaza_SocialLogin/js/popup":<?= $childBlock->getFormParams() ?>}'>
        <?= $block->getChildHtml('request.info') ?>
    </div>
<?php endif; ?>
<style type="text/css">
    .request-popup {
        overflow-y: unset;
        max-width: 800px;
        left: 30%;
    }
    .request-popup .modal-header {
        padding: 0;
    }
    .request-popup .modal-header button.action-close {
        color: white;
        z-index: 100;
    }
    .request-popup .modal-content {
        padding: 0;
    }
    .block-content-register-social .block-content .social-btn {
        width: 230px;
        margin: 0;
        margin-bottom: 10px;
    }
    .block-content-register-social:first-child {
        margin-bottom: 20px;
    }
    .block-content-register-social .block-content-social {
        display: table-caption;
    }
    .block.block-customer-login {
        float: left !important;
    }
    .block.block-new-customer {
        clear: unset !important;
        float: right !important;
    }
    .login-container .block-new-customer .actions-toolbar.account-menus {
        margin-top: 13px !important;
    }
</style>
